<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>食不食油饼</title>
    <link rel="stylesheet" href="css/wz.css">
    <link rel="stylesheet" href="css/home.css">
    <link rel="stylesheet" href="css/about.css">
    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="css/photo.css">
    <link rel="stylesheet" href="css/star.css">
    <link rel="stylesheet" href="css/mp3.css">
    <style></style>
</head>

<body>
    <!-- 导航栏 -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="/" class="logo-box">
                <img src="image/blog.png" alt="" class="logo-1">
            </a>
            <div class="nav-links">
                <a href="#home" class="nav-link">主页</a>
                <a href="#docs" class="nav-link">文档</a>
                <a href="#gallery" class="nav-link">壁纸</a>
                <a href="#about" class="nav-link">关于</a>
            </div>
        </div>
    </nav>
    <!-- 页面容器 -->
    <div id="app">
        <!-- 第一页 -->
        <div id="home-page" class="page" style="display: none;">
            <div class="avt">
                <img src="image/mb.jpg" alt="" data-src="image/mb.jpg" onclick="showImage(this)" id="mbmb">
                <div class="player" id="mp3play">
                    <div class="controls-m">
                        <button class="btn-m" id="prevBtn">
                            <img src="image/syq.png" alt="">
                        </button>
                        <button class="btn-m" id="playBtn">
                            <img src="image/bf.png" alt="">
                        </button>
                        <button class="btn-m" id="nextBtn">
                            <img src="image/xyq.png" alt="">
                        </button>
                    </div>
                    <div class="song-display">
                        <div class="song-text" id="songText">正在加载...</div>
                    </div>
                </div>
                <div class="tt">
                    <div class="tt1">食不食油饼</div>
                    <div class="tt2">与其逼自己一把，不如放自己一马</div>
                    <div class="tt3">曼波~曼波~<br>哦嘛吱哩曼波~哇塞曼波~<br>哦嘛吱哩曼波~</div>
                </div>
            </div>
        </div>
        <!-- 第二页 -->
        <div id="docs-page" class="page" style="display: none;">
            <div class="container-wz">
                <div class="tag-search">
                    <div class="search-box">
                        <input type="text" id="searchInput" placeholder="搜索本页...">
                    </div>
                    <div class="tags-container" id="tagsContainer"></div>
                </div>
                <div id="left-column" class="article-list">
                </div>
            </div>
        </div>
        <!-- 第三页 -->
        <div id="gallery-page" class="page" style="display: none;">
            <div class="container-2">
                <div id="pts" class="photos"></div>
            </div>
        </div>
        <!-- 第四页 -->
        <div id="about-page" class="page" style="display: none;">
        </div>
        <!-- 第五页... -->
    </div>
    <dialog id="hdimg" onclick="hdimg.close()">
        <div class="loading" id="aa"></div>
        <img id="img-hd" alt="">
    </dialog>
    <div class="stars-container" id="starsContainer"></div>

    <audio id="audio" preload="metadata"></audio>
    <script src="js/hdimg.js"></script>
    <script src="js/star.js"></script>
    <script src="js/mp3.js"></script>
    <script>
        // 路由管理类
        class HashRouter {
            constructor() {
                this.routes = {};
                this.currentPage = null;
                this.init();
            }

            init() {
                window.addEventListener('load', this.handleRouteChange.bind(this));
                window.addEventListener('hashchange', this.handleRouteChange.bind(this));
            }

            addRoute(path, pageId) {
                this.routes[path] = pageId;
            }

            handleRouteChange() {
                // 获取当前路由hash，默认值为home
                const path = window.location.hash.substring(1) || 'home';

                // 隐藏所有页面
                const pages = document.querySelectorAll('.page');
                pages.forEach(page => page.style.display = 'none');

                // 更新导航激活状态
                const navLinks = document.querySelectorAll('.nav-link');
                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href').substring(1) === path) {
                        link.classList.add('active');
                    }
                });

                // 显示当前路由对应的页面
                const pageId = this.routes[path] || this.routes['home'];
                const currentPage = document.getElementById(pageId);
                if (currentPage) {
                    currentPage.style.display = 'block';
                    this.currentPage = pageId;
                } else {
                    // 如果路由不存在，显示主页
                    document.getElementById(this.routes['home']).style.display = 'block';
                    this.currentPage = this.routes['home'];
                }
            }
        }

        // 初始化路由
        document.addEventListener('DOMContentLoaded', () => {
            const router = new HashRouter();

            // 添加路由
            router.addRoute('home', 'home-page');
            router.addRoute('docs', 'docs-page');
            router.addRoute('gallery', 'gallery-page');
            router.addRoute('about', 'about-page');
        });

        // 监听hash变化改变背景
        window.addEventListener('load', updateBackground);
        window.addEventListener('hashchange', updateBackground);
        function updateBackground() {
            const hash = window.location.hash;
            const navLinks = document.querySelectorAll('.nav-links a');
            const navbar = document.querySelector('.navbar');
            let bgClass = 'bg-1';
            if (hash == '#home' || hash === '#about') { bgClass = 'bg-1'; }
            else if (hash === '#docs' || hash === '#gallery') { bgClass = 'bg-2'; }
            document.body.className = bgClass;
        }

        // 监听hash变化改变导航栏颜色
        window.addEventListener('load', updateNavLinkColor);
        window.addEventListener('hashchange', updateNavLinkColor);
        function updateNavLinkColor() {
            const hash = window.location.hash;
            const navLinks = document.querySelectorAll('.nav-link');
            const navbar = document.querySelector('.navbar');
            const start = document.getElementById('starsContainer')
            // 设置标题背景色
            navLinks.forEach(link => {
                if (hash === '#docs' || hash === '#gallery') {
                    link.style.color = '#333';
                } else {
                    link.style.color = '#eee';
                }
            });
            // 设置标题栏背景色
            if (hash === '#docs' || hash === '#gallery') {
                navbar.style.backgroundColor = '#fff';
                start.style.display = 'none'
            } else {
                navbar.style.backgroundColor = 'transparent';
                start.style.display = 'block'
            }
        }


        // 监听hash变化加载js
        // 全局变量，记录是否已加载
        let galleryLoaded = false;
        let docsLoaded = false;
        let aboutLoaded = false;
        // let mp3palyLoaded = false;
        window.addEventListener('load', loadGalleryImages)
        window.addEventListener('hashchange', loadGalleryImages);
        function loadGalleryImages() {
            const hash2 = window.location.hash;
            if (hash2 === '#gallery' && !galleryLoaded) {
                const script = document.createElement('script');
                script.src = 'js/imglist.js';
                document.head.appendChild(script);
                galleryLoaded = true;
            }
            else if (hash2 === '#docs' && !docsLoaded) {
                const script = document.createElement('script');
                script.src = 'js/wzlist.js';
                document.head.appendChild(script);
                docsLoaded = true;
            }
            else if (hash2 === '#about' && !aboutLoaded) {
                fetch('about.html')
                    .then(response => response.text())
                    .then(html => {
                        document.getElementById('about-page').innerHTML = html;
                        aboutLoaded = true;
                    })
            }
        }
        // const script = document.createElement('script');
        // script.src = 'js/mp3.js';
        // document.head.appendChild(script);
        // mp3palyLoaded = true;
    </script>
</body>

</html>